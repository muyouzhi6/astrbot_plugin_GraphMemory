"""LLM Prompt 模板"""

# 知识提取 Prompt
EXTRACTION_PROMPT = """你是一个知识图谱提取专家。请从以下对话中提取结构化的知识信息。

对话记录:
{text}

提取任务:
1. **实体提取**: 识别对话中提到的重要实体
   - PERSON: 人物（真实人物、虚拟角色）
   - PLACE: 地点（城市、国家、建筑、虚拟地点）
   - THING: 具体事物（物品、产品、工具）
   - CONCEPT: 抽象概念（技术、理论、方法）
   - EVENT: 事件（活动、会议、历史事件）

2. **关系提取**: 识别实体之间的关系
   - 关系类型: 喜欢、讨厌、拥有、使用、参与、位于、属于等
   - 关系强度: 根据对话中的语气和频率判断

返回格式（严格的 JSON）:
{{
    "entities": [
        {{
            "name": "实体名称",
            "type": "PERSON|PLACE|THING|CONCEPT|EVENT",
            "description": "简洁的描述（1-2句话）"
        }}
    ],
    "relations": [
        {{
            "from": "源实体名称",
            "to": "目标实体名称",
            "relation": "关系类型（动词短语）",
            "evidence": "支持该关系的对话片段"
        }}
    ]
}}

提取规则:
- 只提取对话中**明确提到**的信息，不要推测或补充
- 实体名称使用对话中的**原始表述**
- 描述要**简洁准确**，避免冗余
- 关系描述使用**动词短语**（如"喜欢"、"使用"、"位于"）
- 证据要**直接引用**对话中的相关片段
- 如果没有明确的实体或关系，返回空数组

示例:
对话: "我最近在学习 Python 编程，觉得它很适合数据分析。"
输出:
{{
    "entities": [
        {{"name": "Python", "type": "CONCEPT", "description": "一种编程语言"}},
        {{"name": "数据分析", "type": "CONCEPT", "description": "使用数据进行分析的方法"}}
    ],
    "relations": [
        {{"from": "Python", "to": "数据分析", "relation": "适合用于", "evidence": "它很适合数据分析"}}
    ]
}}

现在请提取上述对话中的知识，只返回 JSON，不要其他解释。
"""

# 查询重写 Prompt
QUERY_REWRITING_PROMPT = """你是一个查询优化专家。请将用户的问题重写为一个独立的、完整的问题，以便在没有上下文的情况下也能理解。

最近对话历史:
{history}

用户当前问题: {query}

重写任务:
1. 分析对话历史，理解用户问题的上下文
2. 将指代词（他、她、它、这个、那个等）替换为具体的实体
3. 补充必要的背景信息，使问题独立完整
4. 保持问题的原始意图和语义

重写规则:
- 如果问题已经是独立完整的，直接返回原问题
- 只补充必要的上下文，不要添加额外信息
- 保持问题的简洁性，避免冗长
- 使用自然的语言表达

示例:
历史: "user: 我喜欢 Python\\nassistant: Python 是一门很好的编程语言"
问题: "它有什么优点？"
重写: "Python 编程语言有什么优点？"

现在请重写用户的问题，只返回重写后的问题，不要其他解释。
"""
