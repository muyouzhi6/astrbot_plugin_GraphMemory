# GitHub Actions å·¥ä½œæµè¯´æ˜

## å·¥ä½œæµåˆ—è¡¨

### 1. auto-release.yml - è‡ªåŠ¨å‘å¸ƒ

**è§¦å‘æ¡ä»¶**ï¼š
- å½“ `metadata.yaml` æ–‡ä»¶ä¸­çš„ `version` å­—æ®µå˜åŒ–æ—¶
- æ¨é€åˆ° `main` åˆ†æ”¯

**åŠŸèƒ½**ï¼š
1. æ£€æµ‹ç‰ˆæœ¬å·æ˜¯å¦æ›´æ–°
2. ä» `CHANGELOG.md` è‡ªåŠ¨æå–å¯¹åº”ç‰ˆæœ¬çš„æ›´æ–°å†…å®¹
3. æ„å»ºå‰ç«¯ï¼ˆnpm buildï¼‰
4. åˆ›å»º Git tagï¼ˆæ ¼å¼ï¼š`v0.5.0`ï¼‰
5. åˆ›å»º GitHub Release
6. ä¸Šä¼ æ‰“åŒ…æ–‡ä»¶ï¼ˆ`.tar.gz` å’Œ `.zip`ï¼‰

**ä½¿ç”¨æ–¹æ³•**ï¼š
```bash
# 1. æ›´æ–°ç‰ˆæœ¬å·
vim metadata.yaml  # ä¿®æ”¹ version: 0.5.0 -> 0.5.1

# 2. æ›´æ–° CHANGELOG.md
vim CHANGELOG.md   # æ·»åŠ  ## [0.5.1] - 2025-12-19 éƒ¨åˆ†

# 3. æäº¤å¹¶æ¨é€
git add metadata.yaml CHANGELOG.md
git commit -m "chore: bump version to 0.5.1"
git push origin main

# 4. GitHub Actions è‡ªåŠ¨å‘å¸ƒ ğŸš€
```

**Release Notes æ ¼å¼**ï¼š

å·¥ä½œæµä¼šä» `CHANGELOG.md` ä¸­æå–ä»¥ä¸‹æ ¼å¼çš„å†…å®¹ï¼š

```markdown
## [0.5.1] - 2025-12-19

### æ–°å¢åŠŸèƒ½
- åŠŸèƒ½æè¿°

### ä¿®å¤é—®é¢˜
- Bug æè¿°

### ä¼˜åŒ–æ”¹è¿›
- ä¼˜åŒ–æè¿°
```

å¦‚æœæ‰¾ä¸åˆ°å¯¹åº”ç‰ˆæœ¬çš„å†…å®¹ï¼Œä¼šä½¿ç”¨é»˜è®¤æ¨¡æ¿ã€‚

---

### 2. release.yml - æ‰‹åŠ¨å‘å¸ƒ

**è§¦å‘æ¡ä»¶**ï¼š
- æ‰‹åŠ¨åˆ›å»º GitHub Release
- æ‰‹åŠ¨è§¦å‘å·¥ä½œæµï¼ˆActions é¡µé¢ï¼‰

**åŠŸèƒ½**ï¼š
1. æ„å»ºå‰ç«¯
2. æ‰“åŒ…æ’ä»¶
3. ä¸Šä¼ åˆ° Release é¡µé¢

**ä½¿ç”¨åœºæ™¯**ï¼š
- éœ€è¦æ‰‹åŠ¨æ§åˆ¶å‘å¸ƒæ—¶æœº
- æµ‹è¯•å‘å¸ƒæµç¨‹
- è¡¥å‘å†å²ç‰ˆæœ¬

---

### 3. build-frontend.yml - å‰ç«¯æ„å»ºæµ‹è¯•

**è§¦å‘æ¡ä»¶**ï¼š
- `webui-src/` ç›®å½•ä¸‹æ–‡ä»¶å˜åŒ–
- Pull Request

**åŠŸèƒ½**ï¼š
- æµ‹è¯•å‰ç«¯æ„å»ºæ˜¯å¦æˆåŠŸ
- ä¸åˆ›å»º Release

---

## å¸¸è§é—®é¢˜

### Q: å¦‚ä½•å‘å¸ƒæ–°ç‰ˆæœ¬ï¼Ÿ

**A: ä½¿ç”¨è‡ªåŠ¨å·¥ä½œæµï¼ˆæ¨èï¼‰**
1. ä¿®æ”¹ `metadata.yaml` ä¸­çš„ç‰ˆæœ¬å·
2. æ›´æ–° `CHANGELOG.md`
3. æäº¤æ¨é€åˆ° main åˆ†æ”¯
4. è‡ªåŠ¨åˆ›å»º Release âœ…

**A: æ‰‹åŠ¨åˆ›å»º Release**
1. åœ¨ GitHub ä¸Šåˆ›å»º Release
2. å¡«å†™ Tag å’Œæè¿°
3. å‘å¸ƒåè‡ªåŠ¨æ„å»º âœ…

### Q: ç‰ˆæœ¬å·æ ¼å¼ï¼Ÿ

éµå¾ªè¯­ä¹‰åŒ–ç‰ˆæœ¬ï¼š`major.minor.patch`

- `major`: ä¸å…¼å®¹çš„ API ä¿®æ”¹
- `minor`: æ–°å¢åŠŸèƒ½ï¼ˆå‘ä¸‹å…¼å®¹ï¼‰
- `patch`: Bug ä¿®å¤

ç¤ºä¾‹ï¼š`0.5.0` -> `0.5.1` -> `0.6.0` -> `1.0.0`

### Q: CHANGELOG.md æ ¼å¼ï¼Ÿ

```markdown
# GraphMemory å˜æ›´æ—¥å¿—

## [0.5.1] - 2025-12-19

### æ–°å¢åŠŸèƒ½
- æ–°åŠŸèƒ½æè¿°

### ä¿®å¤é—®é¢˜
- Bug ä¿®å¤æè¿°

### ä¼˜åŒ–æ”¹è¿›
- æ€§èƒ½ä¼˜åŒ–æè¿°

## [0.5.0] - 2025-12-18
...
```

### Q: å·¥ä½œæµå¤±è´¥æ€ä¹ˆåŠï¼Ÿ

1. æŸ¥çœ‹ Actions é¡µé¢çš„é”™è¯¯æ—¥å¿—
2. å¸¸è§é—®é¢˜ï¼š
   - å‰ç«¯æ„å»ºå¤±è´¥ï¼šæ£€æŸ¥ `webui-src/` ä»£ç 
   - æƒé™é”™è¯¯ï¼šç¡®ä¿ `permissions: contents: write` å·²è®¾ç½®
   - Tag å·²å­˜åœ¨ï¼šåˆ é™¤é‡å¤çš„ tag æˆ–å‡çº§ç‰ˆæœ¬å·

### Q: å¦‚ä½•å›æ»šç‰ˆæœ¬ï¼Ÿ

1. æ¢å¤ `metadata.yaml` åˆ°æ—§ç‰ˆæœ¬
2. æ¨é€åˆ° main
3. æ‰‹åŠ¨åˆ é™¤é”™è¯¯çš„ Release å’Œ Tag

```bash
# åˆ é™¤æœ¬åœ°å’Œè¿œç¨‹ tag
git tag -d v0.5.1
git push origin :refs/tags/v0.5.1

# åœ¨ GitHub ä¸Šåˆ é™¤ Release
```

## æœ€ä½³å®è·µ

1. **æ¯æ¬¡å‘å¸ƒå‰**ï¼š
   - âœ… æ›´æ–° CHANGELOG.md
   - âœ… æµ‹è¯•æ„å»ºï¼š`cd webui-src && npm run build`
   - âœ… è¿è¡Œæµ‹è¯•ï¼š`pytest`

2. **ç‰ˆæœ¬å·è§„èŒƒ**ï¼š
   - å°ä¿®å¤ï¼š`0.5.0` -> `0.5.1`
   - æ–°åŠŸèƒ½ï¼š`0.5.1` -> `0.6.0`
   - å¤§æ›´æ–°ï¼š`0.6.0` -> `1.0.0`

3. **æäº¤ä¿¡æ¯**ï¼š
   ```bash
   git commit -m "chore: bump version to 0.5.1

   - åŠŸèƒ½1
   - åŠŸèƒ½2
   "
   ```

4. **åˆ†æ”¯ç­–ç•¥**ï¼š
   - å¼€å‘ï¼šåœ¨ feature åˆ†æ”¯
   - åˆå¹¶ï¼šPR åˆ° main
   - å‘å¸ƒï¼šmain åˆ†æ”¯æ¨é€è§¦å‘

## å·¥ä½œæµæƒé™

ä¸¤ä¸ªå·¥ä½œæµéƒ½éœ€è¦ `contents: write` æƒé™ï¼š

```yaml
permissions:
  contents: write
```

è¿™å…è®¸å·¥ä½œæµï¼š
- åˆ›å»º Git tag
- åˆ›å»º GitHub Release
- ä¸Šä¼  Release èµ„äº§

## æ„å»ºäº§ç‰©

æ¯æ¬¡å‘å¸ƒä¼šç”Ÿæˆï¼š
1. `astrbot_plugin_GraphMemory.tar.gz` - Linux/macOS ç”¨æˆ·
2. `astrbot_plugin_GraphMemory.zip` - Windows ç”¨æˆ·

æ‰“åŒ…æ—¶ä¼šæ’é™¤ï¼š
- `.git/`
- `webui-src/node_modules/`
- `tests/`
- `__pycache__/`
- å…¶ä»–å¼€å‘æ–‡ä»¶

ç”¨æˆ·ä¸‹è½½åç›´æ¥è§£å‹å³å¯ä½¿ç”¨ï¼Œå‰ç«¯å·²é¢„æ„å»ºã€‚
